========================   chi Truc
Incident #70412 -  extract data Thang 07.2016
extract data Thang 07.2016
Dear IT team,
Vui long extract data Thang 07/2016  nhu thong tin ben duoi nhe. Thanks all

1. PRN scorecard 

2.  Monthly Merck serono :     PRN Code tu M04 den M18  

3.  Monthly report of Menarini cho cac item ben duoi (Data tuong tu nhu monthly Merck serono)
I010150
I010220
I010230
I010240
I010280
I010290
I010290D
I010300

---Scorecard theo local group
SELECT A.PRNCPL, C.CMGRP2, C.CMGRP3, C.CMGRP4,                     
B.COHOTB, SUBSTR(CHAR(COHDAT),5,2),                                
COHSRC,COUNT(DISTINCT A.ORDR),SUM(A.CODOUN ), SUM(A.CODUNT),       
SUM(A.CODVAL)                                                      
 FROM cod a,coh b, cm c WHERE coddel='' and cohdel=''              
and b.cust=c.cust and A.PRNCPL IN ('G03', 'G10') and               
a.ttype=b.ttype and a.ordr=b.ordr and cohdat between 20140101 and  
20141130 GROUP BY A.PRNCPL, C.CMGRP2, C.CMGRP3, C.CMGRP4,          
B.COHOTB, SUBSTR(CHAR(COHDAT),5,2),COHSRC    

---Monthly Merck serono
select b.WHS,ITEM,b.PRNCPL,CODSEQ,CODUNT,CODVAL,COHDAT,CODOUN      
from coh a, cod b                                                  
where a.ttype=b.ttype and a.ordr=b.ordr and cohdel='' and coddel=''
and A.PRNCPL IN (                                                  
'M04','M05','M06','M07','M08','M09','M10','M11',                   
'M12','M13','M14','M15','M16','M17','M18' ) and a.ttype='OR'       
and cohdat between 20160701 and 20160731                                                

---Monthly report of Menarini cho cac item ben duoi (Data tuong tu nhu monthly Merck serono)
select b.WHS,ITEM,b.PRNCPL,CODSEQ,CODUNT,CODVAL,COHDAT,CODOUN       
from coh a, cod b                                                   
where a.ttype=b.ttype and a.ordr=b.ordr and cohdel='' and coddel='' 
and a.ttype='OR'                                                    
and item in ( 'I010150','I010220','I010230','I010240',              
              'I010280','I010290','I010290D','I010300')             
and cohdat between 20160701 and 20160731                            

=====================   Summary report on stocking up customer-Add Route 1 - chi Thai Hang
select 
A.TTYPE, A.ORDR as Order, A.COHDAT as OrderDate, A.CUST as Customer, F.OTSDES as OrderStatus, A.COHSRC as OrderSource, B.CODSTS as DetailStatus, B.PSN as PickingSlip , B.INVNO as Invoice, E.MANFST AS MANIFEST,B.ITEM, B.CODDES as ItemDescription, B.PRNCPL as Princpal, B.WHS as Warehouse, CODOUN as RequestedQty, B.CODUNT as SuppliedQty ,B.CODUBO as BackOrderedQty, B.CODVAL as SuppliedValue, C.COONAM as DeliveryName, C.COOAD1 as DeliveryAddress1, C.COOAD2  as DeliveryAddress2, C.COOAD3  as DeliveryAddress3,  C.COODI1 as DeliveryInstruction1, C.COODI2  as DeliveryInstruction2, C.COODI3  as DeliveryInstruction3,UOPCDE as UrgentOrderCode, ODMK1 as HospitalOrginalDocument, ODPOR As DeliveryDate, C.RTECDE as Route
,G.TTYPE,INVNO,GIVINV,GIVBRF 
from
ZPTLIBD/COH A, ZPTLIBD/COD B, ZPTLIBD/COO C, ZPTLIBD/OD D, ZPTLIBD/OTH E, ZPTLIBD/OTS F,
ZPTLIBD/INH G
where 
INHDEL='' and G.INVNO=E.INVNO AND G.TTYPE IN ('IV','CR') AND 
COHDEL='' AND CODDEL='' AND A.TTYPE=B.TTYPE AND      A.ORDR=B.ORDR AND COHCNL<>'Y' AND A.ORDR=C.ORDR  AND COHSRC = 'SU'     AND COHDAT >= 20160708 and a.ttype = d.ttype and a.ordr = d.ordr AND E.TTYPE = A.TTYPE AND E.ORDR = A.ORDR AND E.OTHSTS = F.OTSSTS  AND B.PSN = E.PSN AND E.OTHSTS <> 'ZZZ' and a.cust in ('S01177')




 OTHDEL  TTYPE        ORDR          PSN        INVNO       MANFST   CUST   
          OR    28,168,960            0            0            0   S01348 
          OR    29,989,369            0            0            0   S00364 
          OR    29,984,378   55,110,406   70,620,055   88,836,885   C00022 
		  
		  
select                                                              
A.TTYPE, A.ORDR as Order, A.COHDAT as OrderDate, A.CUST as Customer,
F.OTSDES as OrderStatus, A.COHSRC as OrderSource, B.CODSTS as       
DetailStatus, B.PSN as PickingSlip , B.INVNO as Invoice, E.MANFST AS
MANIFEST,B.ITEM, B.CODDES as ItemDescription, B.PRNCPL as Princpal, 
B.WHS as Warehouse, CODOUN as RequestedQty, B.CODUNT as SuppliedQty 
,B.CODUBO as BackOrderedQty, B.CODVAL as SuppliedValue, C.COONAM as 
DeliveryName, C.COOAD1 as DeliveryAddress1, C.COOAD2  as            
DeliveryAddress2, C.COOAD3  as DeliveryAddress3,  C.COODI1 as       
DeliveryInstruction1, C.COODI2  as DeliveryInstruction2, C.COODI3   
as DeliveryInstruction3,A.UOPCDE as UrgentOrderCode, ODMK1 as       
HospitalOrginalDocument, ODPOR As DeliveryDate, C.RTECDE as Route   
,G.TTYPE,G.INVNO,GIVINV,GIVBRF                                      
from                                                                
ZPTLIBD/COH A, ZPTLIBD/COD B, ZPTLIBD/COO C, ZPTLIBD/OD D,          
ZPTLIBD/OTH E, ZPTLIBD/OTS F,                                       
ZPTLIBD/INH G                                                       
where                                                               
INHDEL='' and G.INVNO=E.INVNO AND G.TTYPE IN ('IV','CR') AND        
COHDEL='' AND CODDEL='' AND A.TTYPE=B.TTYPE AND      A.ORDR=B.ORDR  
AND COHCNL<>'Y' AND A.ORDR=C.ORDR  AND COHSRC = 'SU'     AND COHDAT 
>= 20160708 and a.ttype = d.ttype and a.ordr = d.ordr AND E.TTYPE = 
A.TTYPE AND E.ORDR = A.ORDR AND E.OTHSTS = F.OTSSTS  AND B.PSN =    
E.PSN AND E.OTHSTS <> 'ZZZ' and a.cust in ('S01177')                

--------------------------- bao cao Sanofi - Vo thi minh thi - ho phuong thao
Submit test report rebate
-	delete from splr where ttype='TS'                       
-	INSERT INTO SPLR VALUES('','TS','RBTS27')      
-	SBMEXLRPT TYPE(TS) DTAQ(ZPTAUTORPT) USER('')

ZPP Sanofi Customer Rebate Q3 2015
/java/SQLS/RBTS27.sql         

 SELECT A.CUST, C.CNAME, C.CADD1, C.CADD2, C.CADD3                  
 ,A.PRNCPL, A."GROUP", a.invno,A.RBHPGM,                            
 A.INCVAL, A.INCDSA, VALUE( B.TTYPE,'') AS                          
  TTYPE, VALUE(B.DOCNO,0) AS DOCNO, VALUE(B.INSVAL,0) AS INSVAL ,   
VALUE(B.INSCTD,0) AS INSCTD                                         
FROM zptlibd/invdsc a left join zptlibd/invdsa b                    
on A.CUST= B.CUST and A.PRNCPL= B.PRNCPL                            
and A."GROUP"= B."GROUP" and A.INVNO= B.INSREF left join zptlibd/cm c 
on a.cust = c.cust WHERE A.PRNCPL='S27' AND A."GROUP" in ('S27ZZZ','SAZZZZ')    
AND A.INCCFD >= 20150930 AND INCDEL=''                              
File TEMP in LDPHUC was replaced.    
========================================================
Incident #69697 -  data extract	- Cao Thanh Thuy
Dear anh/chị,
Vui lòng extract giúp em data theo template đính kèm và thông tin bên dưới nha.

Product: Tanakan, Smecta, Gastropulgite
All channel 
Nationwide
Sales Period: monthly, Jan'15-Jun'15, Jan'16-Jun'16
Cám ơn anh/chị

SELECT A.CUST, A.CNAME, A.CADD1, A.CADD2, A.CADD3, A.CMSTAT,       
A.CMALNM, A.CMALA1, A.CMALA2, A.CMCONT, A.CLASS, A.PLCAR, A.PLCTE, 
A.CMIMS1, A.CMGRP1, A.CMGRP2, A.CMGRP3, A.CMGRP4, B.TTYPE, B.INVNO,
B.INHCFD, B.INHOTB, INHSRC,                                        
 C.STYCDE, C.ITEM, C.INDDES, C.PRNCPL, C.INDCFD,                   
C.INDUNT, C.INDSEL, C.INDGST, C.INDVAL, b.artrm 
FROM cm a, inh b, ind c     
WHERE cmdel='' and inhdel='' and inddel='' and a.cust= b.cust and  
b.ttype=c.ttype and b.invno=c.invno and c.item in ('B040140',      
'B040220', 'B040170' , 'B040090' ) and indcfd between 20160101 and 
20160631   
========================================================
========================================================
Bao cao stock up - Vo Hieu Phuc

SELECT A.TTYPE, A.ORDERNUMBER, A.ORDERDATE, A.CUSTOMER,           
A.ORDERSTATUS, A.ORDERSOURCE, A.DETAILSTATUS, A.PICKINGSLIP,      
A.INVOICE, A.INVOICESEQ, A.MANIFEST, A.ITEM, A.ITEMDESCRIPTION,   
A.PRINCPAL, A.WAREHOUSE, A.REQUESTEDQTY, A.SUPPLIEDQTY,           
A.BACKORDEREDQTY, A.SUPPLIEDVALUE, A.DELIVERYNAME,                
A.DELIVERYADDRESS1, A.DELIVERYADDRESS2, A.DELIVERYADDRESS3,       
A.DELIVERYINSTRUCTION1, A.DELIVERYINSTRUCTION2,                   
A.DELIVERYINSTRUCTION3, A.URGENTORDERCODE,                        
A.HOSPITALORGINALDOCUMENT, A.DELIVERYDATE,                        
A.DELIVEREDONDATE ,value(-Itqty,0) AS INVOICESUPPLIEDQTY          
, value(B.ISL#, ''), 0 as EXPIRYDATE,                             
value(locn,'') as LOCATION,value(itcrtd,0) as INVOICEDATE         
,value(itcrtt,0) as INVOICETIME,GIVBRF,GIVINV,INDCFD 
FROM ZPTLIBD/zstockup a left join 	
ZPTLIBD/it b on INVOICE =batch and INVOICESEQ=bhSEQ AND           
B.TTYPE='IV'

=========================
Scorecard theo local group

SELECT A.PRNCPL, C.CMGRP2, C.CMGRP3, C.CMGRP4,                     
B.COHOTB, SUBSTR(CHAR(COHDAT),5,2),                                
COHSRC,COUNT(DISTINCT A.ORDR),SUM(A.CODOUN ), SUM(A.CODUNT),       
SUM(A.CODVAL)                                                      
 FROM cod a,coh b, cm c WHERE coddel='' and cohdel=''              
and b.cust=c.cust and A.PRNCPL IN ('G03', 'G10') and               
a.ttype=b.ttype and a.ordr=b.ordr and cohdat between 20140101 and  
20141130 GROUP BY A.PRNCPL, C.CMGRP2, C.CMGRP3, C.CMGRP4,          
B.COHOTB, SUBSTR(CHAR(COHDAT),5,2),COHSRC                    

============================
Scorecard – orders taken by
SELECT A.PRNCPL, B.COHOTB, SUBSTR(CHAR(COHDAT),5,2),                
COHSRC,COUNT(DISTINCT A.ORDR),SUM(A.CODOUN ), SUM(A.CODUNT),        
SUM(A.CODVAL) FROM cod a,coh b WHERE coddel='' and cohdel='' and    
a.ttype=b.ttype and a.ordr=b.ordr and cohdat between 20120201 and   
20120229 GROUP BY A.PRNCPL,B.COHOTB, SUBSTR(CHAR(COHDAT),5,2),COHSRC
================================
ZPP Suggested Warehouse Stock Transfer Report - Le Phuong Giang
select * from z9661         
====================================
Bao cao asap: ZIN793 Phyto Sales Details     
=> tao ra file ZIN793PF       
=============================================================
Incident #70616 -  Sales Report in HCM, Hanoi, Da nang in - ntthuy IC - Nguyen Thanh Thuy - report hang lanh 
Sales Report in HCM, Hanoi, Da nang in 2014, 2015, 2016
IT vui lòng hỗ trợ cung cấp sales report của 3 khu vực: Hồ Chí Minh, Hà Nội, Đà Nẵng trong năm 2014, 2015 và 7 tháng đầu năm 2016
Template theo file đính kèm
Cảm ơn.

SELECT b.prncpl,b.item, B.IMDBRN||B.IMDFRM|| B.IMDSTR||B.IMDSIZ as     
ITEM_DESC, substr(char(sasdte),1,4) as YEAR ,plcar,                    
sum( A.SASSQY+                                                         
A.SASSBQ+ A.SASRQY+ A.SASRBQ ) as QTY,sum( A.SASSVL+ A.SASRVL ) as     
VALUE FROM sas a,im b WHERE sasdte between 20140101 and 20160731       
and sasdel='' and a.item=b.item and B.ISTCDE ='COL' and plcar in       
('101','201', '302' , '301', '310', '311', '312', '313', '315')        
GROUP BY b.prncpl,b.item, B.IMDBRN||B.IMDFRM|| B.IMDSTR||B.IMDSIZ,     
substr(char(sasdte),1,4),plcar                                         
File TEMP in LDPHUC was replaced.     